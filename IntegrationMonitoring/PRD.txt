except: false
---

Please implement DDD-based microservice architecture code for an event storming model-based domain using Spring Boot 3 and DDD Extension. The code must be implemented strictly based on the metadata provided below:

IntegrationMonitoring DDD Model:
{"_type":"BoundedContext","aggregates":[{"_type":"Aggregate","aggregateRoot":{"_type":"AggregateRoot","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationStatusId"},{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"IntegrationState","displayName":"","name":"state"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"lastAttemptedAt"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"lastSucceededAt"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"lastFailedAt"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"failureReason"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"retryCount"}]},"commands":[{"_type":"Command","controllerInfo":{"apiPath":"connectpaymentgateway","fullApiPath":"","method":"POST"},"displayName":"결제 게이트웨이 연동 시도","examples":[{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"failureReason":"Timeout","integrationStatusId":1,"lastAttemptedAt":"2024-06-01T10:00:00Z","lastFailedAt":"2024-06-01T10:00:00Z","retryCount":2,"state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayConnected","type":"Event","value":{"integrationStatusId":1,"lastSucceededAt":"2024-06-02T09:00:00Z","state":"CONNECTED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"ConnectPaymentGateway","type":"Command","value":{"attemptedAt":"2024-06-02T09:00:00Z","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"attemptedAt"}],"isRestRepository":false,"name":"ConnectPaymentGateway","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist"},{"_type":"Command","controllerInfo":{"apiPath":"failpaymentgatewayconnection","fullApiPath":"","method":"POST"},"displayName":"결제 게이트웨이 연동 실패 기록","examples":[{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"integrationStatusId":2,"lastAttemptedAt":"2024-06-02T09:00:00Z","retryCount":1,"state":"RETRYING","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayConnectionFailed","type":"Event","value":{"failureReason":"API 인증 오류","integrationStatusId":2,"lastFailedAt":"2024-06-02T09:05:00Z","state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"FailPaymentGatewayConnection","type":"Command","value":{"failedAt":"2024-06-02T09:05:00Z","failureReason":"API 인증 오류","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]},{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"failureReason":"API 인증 오류","integrationStatusId":3,"lastAttemptedAt":"2024-06-02T09:00:00Z","lastFailedAt":"2024-06-02T09:05:00Z","retryCount":3,"state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayConnectionFailed","type":"Event","value":{"failureReason":"","integrationStatusId":3,"lastFailedAt":"2024-06-02T09:10:00Z","state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"FailPaymentGatewayConnection","type":"Command","value":{"failedAt":"2024-06-02T09:10:00Z","failureReason":"","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"failureReason"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"failedAt"}],"isRestRepository":false,"name":"FailPaymentGatewayConnection","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist"},{"_type":"Command","controllerInfo":{"apiPath":"retrypaymentgatewayconnection","fullApiPath":"","method":"POST"},"displayName":"결제 게이트웨이 연동 재시도","examples":[{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"failureReason":"API 인증 오류","integrationStatusId":4,"lastAttemptedAt":"2024-06-02T09:05:00Z","lastFailedAt":"2024-06-02T09:05:00Z","retryCount":1,"state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayRetried","type":"Event","value":{"integrationStatusId":4,"retriedAt":"2024-06-02T09:10:00Z","retryCount":2,"retryResult":"SUCCESS","state":"RETRYING","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"RetryPaymentGatewayConnection","type":"Command","value":{"lastFailureReason":"API 인증 오류","retriedAt":"2024-06-02T09:10:00Z","retryCount":2,"target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]},{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"integrationStatusId":5,"lastAttemptedAt":"2024-06-02T09:10:00Z","lastSucceededAt":"2024-06-02T09:10:00Z","retryCount":0,"state":"CONNECTED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayRetried","type":"Event","value":{"integrationStatusId":5,"retriedAt":"2024-06-02T09:15:00Z","retryCount":1,"retryResult":"NOT_APPLICABLE","state":"RETRYING","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"RetryPaymentGatewayConnection","type":"Command","value":{"lastFailureReason":"","retriedAt":"2024-06-02T09:15:00Z","retryCount":1,"target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"lastFailureReason"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"retryCount"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"retriedAt"}],"isRestRepository":false,"name":"RetryPaymentGatewayConnection","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist"}],"displayName":"연동상태","name":"IntegrationStatus","type":"Aggregate","lifeCycles":[{"trigger":"PrePersist","commands":[{"_type":"Command","controllerInfo":{"apiPath":"connectpaymentgateway","fullApiPath":"","method":"POST"},"displayName":"결제 게이트웨이 연동 시도","examples":[{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"failureReason":"Timeout","integrationStatusId":1,"lastAttemptedAt":"2024-06-01T10:00:00Z","lastFailedAt":"2024-06-01T10:00:00Z","retryCount":2,"state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayConnected","type":"Event","value":{"integrationStatusId":1,"lastSucceededAt":"2024-06-02T09:00:00Z","state":"CONNECTED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"ConnectPaymentGateway","type":"Command","value":{"attemptedAt":"2024-06-02T09:00:00Z","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"attemptedAt"}],"isRestRepository":false,"name":"ConnectPaymentGateway","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist"},{"_type":"Command","controllerInfo":{"apiPath":"failpaymentgatewayconnection","fullApiPath":"","method":"POST"},"displayName":"결제 게이트웨이 연동 실패 기록","examples":[{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"integrationStatusId":2,"lastAttemptedAt":"2024-06-02T09:00:00Z","retryCount":1,"state":"RETRYING","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayConnectionFailed","type":"Event","value":{"failureReason":"API 인증 오류","integrationStatusId":2,"lastFailedAt":"2024-06-02T09:05:00Z","state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"FailPaymentGatewayConnection","type":"Command","value":{"failedAt":"2024-06-02T09:05:00Z","failureReason":"API 인증 오류","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]},{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"failureReason":"API 인증 오류","integrationStatusId":3,"lastAttemptedAt":"2024-06-02T09:00:00Z","lastFailedAt":"2024-06-02T09:05:00Z","retryCount":3,"state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayConnectionFailed","type":"Event","value":{"failureReason":"","integrationStatusId":3,"lastFailedAt":"2024-06-02T09:10:00Z","state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"FailPaymentGatewayConnection","type":"Command","value":{"failedAt":"2024-06-02T09:10:00Z","failureReason":"","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"failureReason"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"failedAt"}],"isRestRepository":false,"name":"FailPaymentGatewayConnection","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist"},{"_type":"Command","controllerInfo":{"apiPath":"retrypaymentgatewayconnection","fullApiPath":"","method":"POST"},"displayName":"결제 게이트웨이 연동 재시도","examples":[{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"failureReason":"API 인증 오류","integrationStatusId":4,"lastAttemptedAt":"2024-06-02T09:05:00Z","lastFailedAt":"2024-06-02T09:05:00Z","retryCount":1,"state":"FAILED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayRetried","type":"Event","value":{"integrationStatusId":4,"retriedAt":"2024-06-02T09:10:00Z","retryCount":2,"retryResult":"SUCCESS","state":"RETRYING","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"RetryPaymentGatewayConnection","type":"Command","value":{"lastFailureReason":"API 인증 오류","retriedAt":"2024-06-02T09:10:00Z","retryCount":2,"target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]},{"given":[{"name":"IntegrationStatus","type":"Aggregate","value":{"integrationStatusId":5,"lastAttemptedAt":"2024-06-02T09:10:00Z","lastSucceededAt":"2024-06-02T09:10:00Z","retryCount":0,"state":"CONNECTED","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"then":[{"name":"PaymentGatewayRetried","type":"Event","value":{"integrationStatusId":5,"retriedAt":"2024-06-02T09:15:00Z","retryCount":1,"retryResult":"NOT_APPLICABLE","state":"RETRYING","target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}],"when":[{"name":"RetryPaymentGatewayConnection","type":"Command","value":{"lastFailureReason":"","retriedAt":"2024-06-02T09:15:00Z","retryCount":1,"target":{"endpoint":"https://api.kcp.com","systemName":"PG_KCP"}}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"lastFailureReason"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"retryCount"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"retriedAt"}],"isRestRepository":false,"name":"RetryPaymentGatewayConnection","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist"}]}]},{"_type":"Aggregate","aggregateRoot":{"_type":"AggregateRoot","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"},{"_type":"FieldDescriptor","className":"FailureType","displayName":"","name":"failureType"},{"_type":"FieldDescriptor","className":"FailureDetail","displayName":"","name":"failureDetail"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"targetSystem"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"occurredAt"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"retryCount"},{"_type":"FieldDescriptor","className":"RetryResult","displayName":"","name":"retryResult"},{"_type":"FieldDescriptor","className":"Boolean","displayName":"","name":"notified"},{"_type":"FieldDescriptor","className":"IntegrationStatusId","displayName":"","name":"integrationStatusId"}]},"commands":[{"_type":"Command","controllerInfo":{"apiPath":"recoverintegrationfailure","fullApiPath":"","method":"PATCH"},"displayName":"외부 연동 장애 복구 처리","examples":[{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"429","errorMessage":"API limit exceeded","requestPayload":"{location:'Seoul'}","responsePayload":"N/A"},"failureType":"LOCATION_WEATHER_API","integrationFailureHistoryId":1002,"integrationStatusId":2002,"notified":true,"occurredAt":"2024-06-01T11:00:00Z","retryCount":2,"retryResult":"FAILURE","targetSystem":"WEATHER_API"}}],"then":[{"name":"IntegrationFailureRecovered","type":"Event","value":{"integrationFailureHistoryId":1002,"notified":true,"recoveredAt":"2024-06-01T12:00:00Z","retryResult":"SUCCESS"}}],"when":[{"name":"RecoverIntegrationFailure","type":"Command","value":{"integrationFailureHistoryId":1002,"recoveredAt":"2024-06-01T12:00:00Z","retryResult":"SUCCESS"}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"},{"_type":"FieldDescriptor","className":"RetryResult","displayName":"","name":"retryResult"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"recoveredAt"}],"isRestRepository":false,"name":"RecoverIntegrationFailure","restRepositoryInfo":{"method":"PATCH"},"trigger":"@PrePersist"},{"_type":"Command","controllerInfo":{"apiPath":"recordintegrationfailure","fullApiPath":"","method":"POST"},"displayName":"외부 연동 장애 이력 기록","examples":[{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"504","errorMessage":"Timeout occurred","requestPayload":"{amount:1000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1001,"integrationStatusId":2001,"notified":false,"occurredAt":"2024-06-01T10:00:00Z","retryCount":0,"retryResult":"NOT_APPLICABLE","targetSystem":"PG_KCP"}}],"then":[{"name":"IntegrationFailureRecorded","type":"Event","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"504","errorMessage":"Timeout occurred","requestPayload":"{amount:1000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1001,"integrationStatusId":2001,"notified":true,"occurredAt":"2024-06-01T10:00:00Z","targetSystem":"PG_KCP"}}],"when":[{"name":"RecordIntegrationFailure","type":"Command","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"504","errorMessage":"Timeout occurred","requestPayload":"{amount:1000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationStatusId":2001,"occurredAt":"2024-06-01T10:00:00Z","targetSystem":"PG_KCP"}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"FailureType","displayName":"","name":"failureType"},{"_type":"FieldDescriptor","className":"FailureDetail","displayName":"","name":"failureDetail"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"targetSystem"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"occurredAt"},{"_type":"FieldDescriptor","className":"IntegrationStatusId","displayName":"","name":"integrationStatusId"}],"isRestRepository":false,"name":"RecordIntegrationFailure","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist","type":"Command"},{"_type":"Command","controllerInfo":{"apiPath":"retryintegrationfailure","fullApiPath":"","method":"PATCH"},"displayName":"외부 연동 장애 재시도","examples":[{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"502","errorMessage":"Connection refused","requestPayload":"{amount:2000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1003,"integrationStatusId":2003,"notified":true,"occurredAt":"2024-06-01T09:00:00Z","retryCount":1,"retryResult":"FAILURE","targetSystem":"PG_KCP"}}],"then":[{"name":"IntegrationFailureRetried","type":"Event","value":{"integrationFailureHistoryId":1003,"notified":true,"retriedAt":"2024-06-01T09:30:00Z","retryCount":2,"retryResult":"SUCCESS"}}],"when":[{"name":"RetryIntegrationFailure","type":"Command","value":{"integrationFailureHistoryId":1003,"retriedAt":"2024-06-01T09:30:00Z","retryCount":2}}]},{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"502","errorMessage":"Connection refused","requestPayload":"{amount:2000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1004,"integrationStatusId":2004,"notified":true,"occurredAt":"2024-06-01T09:00:00Z","retryCount":3,"retryResult":"FAILURE","targetSystem":"PG_KCP"}}],"then":[{"name":"IntegrationFailureRetried","type":"Event","value":{"integrationFailureHistoryId":1004,"notified":true,"retriedAt":"2024-06-01T09:40:00Z","retryCount":4,"retryResult":"FAILURE"}}],"when":[{"name":"RetryIntegrationFailure","type":"Command","value":{"integrationFailureHistoryId":1004,"retriedAt":"2024-06-01T09:40:00Z","retryCount":4}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"retryCount"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"retriedAt"}],"isRestRepository":false,"name":"RetryIntegrationFailure","restRepositoryInfo":{"method":"PATCH"},"trigger":"@PrePersist"}],"displayName":"장애이력이력","events":[{"_type":"Event","displayName":"외부 연동 장애 이력 생성됨","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"},{"_type":"FieldDescriptor","className":"FailureType","displayName":"","name":"failureType"},{"_type":"FieldDescriptor","className":"FailureDetail","displayName":"","name":"failureDetail"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"targetSystem"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"occurredAt"},{"_type":"FieldDescriptor","className":"IntegrationStatusId","displayName":"","name":"integrationStatusId"},{"_type":"FieldDescriptor","className":"Boolean","displayName":"","name":"notified"}],"name":"IntegrationFailureRecorded","trigger":"","type":"Event"}],"name":"IntegrationFailureHistory","type":"Aggregate","lifeCycles":[{"trigger":"PrePersist","commands":[{"_type":"Command","controllerInfo":{"apiPath":"recoverintegrationfailure","fullApiPath":"","method":"PATCH"},"displayName":"외부 연동 장애 복구 처리","examples":[{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"429","errorMessage":"API limit exceeded","requestPayload":"{location:'Seoul'}","responsePayload":"N/A"},"failureType":"LOCATION_WEATHER_API","integrationFailureHistoryId":1002,"integrationStatusId":2002,"notified":true,"occurredAt":"2024-06-01T11:00:00Z","retryCount":2,"retryResult":"FAILURE","targetSystem":"WEATHER_API"}}],"then":[{"name":"IntegrationFailureRecovered","type":"Event","value":{"integrationFailureHistoryId":1002,"notified":true,"recoveredAt":"2024-06-01T12:00:00Z","retryResult":"SUCCESS"}}],"when":[{"name":"RecoverIntegrationFailure","type":"Command","value":{"integrationFailureHistoryId":1002,"recoveredAt":"2024-06-01T12:00:00Z","retryResult":"SUCCESS"}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"},{"_type":"FieldDescriptor","className":"RetryResult","displayName":"","name":"retryResult"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"recoveredAt"}],"isRestRepository":false,"name":"RecoverIntegrationFailure","restRepositoryInfo":{"method":"PATCH"},"trigger":"@PrePersist"},{"_type":"Command","controllerInfo":{"apiPath":"recordintegrationfailure","fullApiPath":"","method":"POST"},"displayName":"외부 연동 장애 이력 기록","examples":[{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"504","errorMessage":"Timeout occurred","requestPayload":"{amount:1000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1001,"integrationStatusId":2001,"notified":false,"occurredAt":"2024-06-01T10:00:00Z","retryCount":0,"retryResult":"NOT_APPLICABLE","targetSystem":"PG_KCP"}}],"then":[{"name":"IntegrationFailureRecorded","type":"Event","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"504","errorMessage":"Timeout occurred","requestPayload":"{amount:1000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1001,"integrationStatusId":2001,"notified":true,"occurredAt":"2024-06-01T10:00:00Z","targetSystem":"PG_KCP"}}],"when":[{"name":"RecordIntegrationFailure","type":"Command","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"504","errorMessage":"Timeout occurred","requestPayload":"{amount:1000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationStatusId":2001,"occurredAt":"2024-06-01T10:00:00Z","targetSystem":"PG_KCP"}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"FailureType","displayName":"","name":"failureType"},{"_type":"FieldDescriptor","className":"FailureDetail","displayName":"","name":"failureDetail"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"targetSystem"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"occurredAt"},{"_type":"FieldDescriptor","className":"IntegrationStatusId","displayName":"","name":"integrationStatusId"}],"isRestRepository":false,"name":"RecordIntegrationFailure","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist","type":"Command"},{"_type":"Command","controllerInfo":{"apiPath":"retryintegrationfailure","fullApiPath":"","method":"PATCH"},"displayName":"외부 연동 장애 재시도","examples":[{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"502","errorMessage":"Connection refused","requestPayload":"{amount:2000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1003,"integrationStatusId":2003,"notified":true,"occurredAt":"2024-06-01T09:00:00Z","retryCount":1,"retryResult":"FAILURE","targetSystem":"PG_KCP"}}],"then":[{"name":"IntegrationFailureRetried","type":"Event","value":{"integrationFailureHistoryId":1003,"notified":true,"retriedAt":"2024-06-01T09:30:00Z","retryCount":2,"retryResult":"SUCCESS"}}],"when":[{"name":"RetryIntegrationFailure","type":"Command","value":{"integrationFailureHistoryId":1003,"retriedAt":"2024-06-01T09:30:00Z","retryCount":2}}]},{"given":[{"name":"IntegrationFailureHistory","type":"Aggregate","value":{"failureDetail":{"additionalInfo":"N/A","errorCode":"502","errorMessage":"Connection refused","requestPayload":"{amount:2000}","responsePayload":"N/A"},"failureType":"PAYMENT_GATEWAY","integrationFailureHistoryId":1004,"integrationStatusId":2004,"notified":true,"occurredAt":"2024-06-01T09:00:00Z","retryCount":3,"retryResult":"FAILURE","targetSystem":"PG_KCP"}}],"then":[{"name":"IntegrationFailureRetried","type":"Event","value":{"integrationFailureHistoryId":1004,"notified":true,"retriedAt":"2024-06-01T09:40:00Z","retryCount":4,"retryResult":"FAILURE"}}],"when":[{"name":"RetryIntegrationFailure","type":"Command","value":{"integrationFailureHistoryId":1004,"retriedAt":"2024-06-01T09:40:00Z","retryCount":4}}]}],"fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"retryCount"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"retriedAt"}],"isRestRepository":false,"name":"RetryIntegrationFailure","restRepositoryInfo":{"method":"PATCH"},"trigger":"@PrePersist"}]}]}],"displayName":"외부연동모니터링","name":"IntegrationMonitoring","policies":[{"_type":"Policy","displayName":"외부 연동 장애 모니터링 알림","name":"IntegrationFailureNotification","type":"Policy","incomingRelations":[{"source":{"_type":"Event","displayName":"위치/날씨 정보 제공 실패됨","name":"LocationWeatherInfoFailed","trigger":"","type":"Event","incomingRelations":[{"source":{"_type":"Command","controllerInfo":{"apiPath":"providelocationweatherinfo","fullApiPath":"","method":"POST"},"displayName":"위치/날씨 정보 제공 요청","examples":[{"given":[{"name":"LocationWeatherInfo","type":"Aggregate","value":{"campsiteId":{"campsiteId":2001},"errorMessage":"N/A","humidity":60,"location":"경기도 가평군 청평면","locationWeatherInfoId":1001,"providedAt":"2024-06-10T09:00:00Z","temperature":22.5,"weatherStatus":"SUNNY"}}],"then":[{"name":"LocationWeatherInfoProvided","type":"Event","value":{"campsiteId":{"campsiteId":2001},"humidity":58,"location":"경기도 가평군 청평면","locationWeatherInfoId":1002,"providedAt":"2024-06-10T09:05:01Z","temperature":23,"weatherStatus":"SUNNY"}}],"when":[{"name":"ProvideLocationWeatherInfo","type":"Command","value":{"campsiteId":{"campsiteId":2001},"requestedAt":"2024-06-10T09:05:00Z"}}]},{"given":[{"name":"LocationWeatherInfo","type":"Aggregate","value":{"campsiteId":{"campsiteId":2002},"location":"강원도 평창군 대관령면","locationWeatherInfoId":1003,"weatherStatus":"UNKNOWN"}}],"then":[{"name":"LocationWeatherInfoFailed","type":"Event","value":{"campsiteId":{"campsiteId":2002},"errorMessage":"외부 API 응답 지연","locationWeatherInfoId":1003,"requestedAt":"2024-06-10T10:00:00Z"}}],"when":[{"name":"ProvideLocationWeatherInfo","type":"Command","value":{"campsiteId":{"campsiteId":2002},"requestedAt":"2024-06-10T10:00:00Z"}}]},{"given":[{"name":"LocationWeatherInfo","type":"Aggregate","value":{"campsiteId":{"campsiteId":2003},"location":"전라남도 완도군","locationWeatherInfoId":1004,"weatherStatus":"UNKNOWN"}}],"then":[{"name":"LocationWeatherInfoFailed","type":"Event","value":{"campsiteId":{"campsiteId":2003},"errorMessage":"위치 정보 없음","locationWeatherInfoId":1004,"requestedAt":"2024-06-10T11:00:00Z"}}],"when":[{"name":"ProvideLocationWeatherInfo","type":"Command","value":{"campsiteId":{"campsiteId":2003},"requestedAt":"2024-06-10T11:00:00Z"}}]}],"isRestRepository":false,"name":"ProvideLocationWeatherInfo","restRepositoryInfo":{"method":"POST"},"trigger":"@PrePersist","type":"Command"}}]}}]}],"readModels":[{"_type":"View","displayName":"외부 연동 상태 상세","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","name":"id"}],"name":"IntegrationStatusDetails","queryOption":{"apiPath":""},"queryParameters":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationStatusId"}]},{"_type":"View","displayName":"외부 연동 상태 목록","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","name":"id"}],"name":"IntegrationStatusList","queryOption":{"apiPath":""},"queryParameters":[{"_type":"FieldDescriptor","className":"IntegrationTarget","displayName":"","name":"target"},{"_type":"FieldDescriptor","className":"IntegrationState","displayName":"","name":"state"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"lastAttemptedAtFrom"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"lastAttemptedAtTo"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"page"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"size"}]},{"_type":"View","displayName":"외부 연동 장애 이력 목록 조회","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","name":"id"}],"name":"IntegrationFailureHistoryList","queryOption":{"apiPath":""},"queryParameters":[{"_type":"FieldDescriptor","className":"FailureType","displayName":"","name":"failureType"},{"_type":"FieldDescriptor","className":"String","displayName":"","name":"targetSystem"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"occurredAtFrom"},{"_type":"FieldDescriptor","className":"Date","displayName":"","name":"occurredAtTo"},{"_type":"FieldDescriptor","className":"RetryResult","displayName":"","name":"retryResult"},{"_type":"FieldDescriptor","className":"Boolean","displayName":"","name":"notified"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"page"},{"_type":"FieldDescriptor","className":"Integer","displayName":"","name":"size"}]},{"_type":"View","displayName":"외부 연동 장애 이력 상세 조회","fieldDescriptors":[{"_type":"FieldDescriptor","className":"Long","name":"id"}],"name":"IntegrationFailureHistoryDetails","queryOption":{"apiPath":""},"queryParameters":[{"_type":"FieldDescriptor","className":"Long","displayName":"","name":"integrationFailureHistoryId"}]}]}
